version: "3.7"

services:
  app_proxy:
    environment:
      APP_HOST: beammeup_frontend_1
      APP_PORT: 8201

  # Interface Web
  frontend:
    image: joshuagessner/beammeup-frontend:latest
    restart: unless-stopped
    environment:
      - BACKEND_URL=http://backend:8200
    depends_on:
      - backend

  # API de gestion
  backend:
    image: joshuagessner/beammeup-backend:latest
    restart: unless-stopped
    volumes:
      - ${APP_DATA_DIR}/data:/app/data
    environment:
      - NODE_ENV=production
      - PORT=8200

  # Le serveur de jeu BeamMP lui-mÃªme
  beammp:
    image: joshuagessner/beammeup-beammp:latest
    restart: unless-stopped
    ports:
      - "30814:30814/udp"
    volumes:
      - ${APP_DATA_DIR}/data/beammp:/server
    depends_on:
      - backend